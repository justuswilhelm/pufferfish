#!/usr/bin/env fish
set output_file "$(mktemp).png"

if [ -z $argv[1] ]
    message "Hello, World!"
else
    message $argv[1]
end

if ! set font (fc-match sans file | cut -d= -f2)
    echo "Couldn't find font"
    set font ""
end

if ! convert \
        -font $font \
        -size 1024x768 xc:white \
        -gravity center \
        -pointsize 24 \
        -fill black \
        -annotate +0+0 \
        $message \
        $output_file
    swaylock \
        --show-failed-attempts \
        --color ff6e67 \
        --daemonize
else
    swaylock \
        --show-failed-attempts \
        --color ff6e67 \
        --daemonize \
        --image $output_file
end
